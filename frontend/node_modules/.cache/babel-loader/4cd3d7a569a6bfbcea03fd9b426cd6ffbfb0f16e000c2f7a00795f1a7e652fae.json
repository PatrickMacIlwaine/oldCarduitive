{"ast":null,"code":"import _slicedToArray from\"/Users/Patrick/CodingFolder/Projects/psychic/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import{useParams}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ChatPage(props){var _useParams=useParams(),roomId=_useParams.roomId;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),messages=_useState2[0],setMessages=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),newMessage=_useState4[0],setNewMessage=_useState4[1];function fetchMessages(roomId){return fetch(\"http://localhost:3001/message/\".concat(roomId)).then(function(response){if(!response.ok){throw new Error(\"HTTP error! status: \".concat(response.status));}return response.json();}).catch(function(e){console.error('There was a problem with your fetch operation: '+e.message);});}function sendMessages(roomId,message){return fetch(\"http://localhost:3001/message/\".concat(roomId),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({text:message})});}function deleteRoom(roomId){return fetch(\"http://localhost:3001/message/\".concat(roomId),{method:'DELETE'});}useEffect(function(){console.log(\"Room ID : \".concat(roomId));var intervalID=setInterval(function(){fetchMessages(roomId).then(setMessages);},5000);return function(){return clearInterval(intervalID);};},[roomId]);var handelSumbit=function handelSumbit(event){event.preventDefault();sendMessages(roomId,newMessage).then(function(){return setNewMessage('');}).then(function(){return fetchMessages(roomId).then(setMessages);});};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Hello World\"}),/*#__PURE__*/_jsxs(\"h1\",{children:[\" Chat Room : \",roomId]}),/*#__PURE__*/_jsx(\"h2\",{children:\" Messages : \"}),Array.isArray(messages)&&messages.map(function(message,index){return/*#__PURE__*/_jsx(\"p\",{children:message.text},index);}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handelSumbit,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newMessage,onChange:function onChange(event){return setNewMessage(event.target.value);}}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Send\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return deleteRoom(roomId);},children:\"Delete this chat room\"})]});}export default ChatPage;","map":{"version":3,"names":["React","useEffect","useState","useParams","jsx","_jsx","jsxs","_jsxs","ChatPage","props","_useParams","roomId","_useState","_useState2","_slicedToArray","messages","setMessages","_useState3","_useState4","newMessage","setNewMessage","fetchMessages","fetch","concat","then","response","ok","Error","status","json","catch","e","console","error","message","sendMessages","method","headers","body","JSON","stringify","text","deleteRoom","log","intervalID","setInterval","clearInterval","handelSumbit","event","preventDefault","children","Array","isArray","map","index","onSubmit","type","value","onChange","target","onClick"],"sources":["/Users/Patrick/CodingFolder/Projects/psychic/frontend/src/components/ChatPage.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useParams } from \"react-router-dom\";\n\nfunction ChatPage(props){\n\n  const { roomId }= useParams();\n  \n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n\n\n  function fetchMessages(roomId) {\n    return fetch(`http://localhost:3001/message/${roomId}`)\n    .then(response => {\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n      return response.json();\n    })\n    .catch(e => {\n      console.error('There was a problem with your fetch operation: ' + e.message);\n    });\n  }\n\n  function sendMessages(roomId, message) {\n    return fetch(`http://localhost:3001/message/${roomId}`, {\n      method: 'POST',\n      headers: {\n        'Content-Type' : 'application/json',\n      },\n      body: JSON.stringify({text: message}),\n    });\n  }\n\n  function deleteRoom(roomId) {\n    return fetch(`http://localhost:3001/message/${roomId}`, {\n      method: 'DELETE',\n    });\n  }\n\n  useEffect(() =>  {\n\n    console.log(`Room ID : ${roomId}`);\n    const intervalID = setInterval(() => {\n      fetchMessages(roomId).then(setMessages);\n    }, 5000);\n\n    return () => clearInterval(intervalID);\n  }, [roomId]);\n\n  const handelSumbit = (event) => {\n    event.preventDefault();\n    sendMessages(roomId, newMessage)\n    .then(() => setNewMessage(''))\n    .then(() => fetchMessages(roomId).then(setMessages));\n  };\n\n  \n\n\nreturn (\n  <div> \n    <h1>Hello World</h1>\n    <h1> Chat Room : {roomId}</h1>\n    <h2> Messages : </h2>\n    {Array.isArray(messages) && messages.map((message, index) => (\n  <p key = {index}>{message.text}</p>\n))}\n    \n\n    <form onSubmit = {handelSumbit}>\n      <input\n      type = \"text\"\n      value = {newMessage}\n      onChange = {event => setNewMessage(event.target.value)}     \n      />\n      <button type=\"submit\">Send</button>\n\n    </form>\n\n\n    <button onClick={() => deleteRoom(roomId)}>Delete this chat room</button>\n\n    \n  </div>\n\n);\n}\nexport default ChatPage;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}